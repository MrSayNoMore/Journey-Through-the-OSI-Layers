<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neo's Signal Quest: Journey Through the OSI Layers</title>
    
    <!-- Favicon -->
    <link href="assets/IMAGES/PayStack_Logo-removebg-preview.png" rel="icon">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&family=Open+Sans:wght@400;700&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,600;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    
    <!-- Vendor CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #4fc3f7;
            --primary-dark: #1e3c72;
            --success-color: #2e7d32;
            --error-color: #c62828;
            --dark-bg: #121212;
            --card-bg: #1e1e1e;
            --text-light: #eaeaea;
            --text-muted: #999;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-light);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        .container {
            flex: 1;
            width: 90%;
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
            position: relative;
            z-index: 1;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-dark), #3a5f8a);
            color: white;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-color);
            position: relative;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .game-area {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
            border: 1px solid rgba(79, 195, 247, 0.1);
        }
        
        .narrative {
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 2rem;
        }
        
        .game-interface {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .choices {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .choice-btn {
            background-color: #2a3f5a;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 200px;
            text-align: left;
        }
        
        .choice-btn:hover {
            background-color: #3a5f8a;
            box-shadow: 0 6px 12px rgba(79, 195, 247, 0.4);
            transform: translateY(-3px);
        }
        
        .layer-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            background-color: #333;
            padding: 0.8rem;
            border-radius: 10px;
        }
        
        .layer {
            text-align: center;
            padding: 0.8rem 0.5rem;
            border-radius: 8px;
            min-width: 80px;
            transition: all 0.3s ease;
        }
        
        .layer.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.7);
            font-weight: 500;
        }
        
        .layer.completed {
            background: linear-gradient(135deg, var(--success-color), #4caf50);
            color: white;
            font-weight: 500;
        }
        
        .feedback {
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 10px;
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .success {
            background-color: rgba(46, 125, 50, 0.3);
            border-left: 5px solid var(--success-color);
        }
        
        .failure {
            background-color: rgba(198, 40, 40, 0.3);
            border-left: 5px solid var(--error-color);
        }
        
        .info-panel {
            background-color: #263238;
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1.5rem;
        }
        
        .layer-description {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #ccc;
        }
        
        .game-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }
        
        button {
            border: none;
            border-radius: 8px;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        #next-btn, #retry-btn {
            background: linear-gradient(135deg, var(--primary-color), #3a5f8a);
            color: #121212;
            display: none;
        }
        
        .progress-bar-container {
            height: 12px;
            background-color: #333;
            border-radius: 10px;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
            width: 0%;
            transition: width 0.8s ease;
        }
        
        #restart-btn {
            background: linear-gradient(135deg, #555, #777);
            color: white;
        }
        
        .scene-image-container {
            width: 100%;
            height: 200px;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #333, #444);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--text-muted);
            font-size: 1.2rem;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(79, 195, 247, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(79, 195, 247, 0); }
            100% { box-shadow: 0 0 0 0 rgba(79, 195, 247, 0); }
        }
        
        @media (max-width: 768px) {
            .layer-indicator {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .layer {
                min-width: calc(33% - 0.5rem);
                padding: 0.5rem;
                font-size: 0.9rem;
            }
            
            .choice-btn {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Neo's Signal Quest</h1>
        <p>Journey Through the OSI Layers</p>
    </header>
    
    <div class="container">
        <div class="progress-bar-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <div class="layer-indicator" id="layer-indicator">
            <div class="layer" data-layer="7">
                <i class="bi bi-app-indicator"></i> 7: Application
            </div>
            <div class="layer" data-layer="6">
                <i class="bi bi-file-earmark-binary"></i> 6: Presentation
            </div>
            <div class="layer" data-layer="5">
                <i class="bi bi-people"></i> 5: Session
            </div>
            <div class="layer" data-layer="4">
                <i class="bi bi-truck"></i> 4: Transport
            </div>
            <div class="layer" data-layer="3">
                <i class="bi bi-diagram-3"></i> 3: Network
            </div>
            <div class="layer" data-layer="2">
                <i class="bi bi-hdd-network"></i> 2: Data Link
            </div>
            <div class="layer" data-layer="1">
                <i class="bi bi-wifi"></i> 1: Physical
            </div>
        </div>
        
        <div class="game-area">
            <div class="scene-image-container" id="scene-image">
                <div>
                    <i class="bi bi-globe" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                    <p>Neo's Network Adventure</p>
                </div>
            </div>
            
            <div class="narrative" id="narrative">
                Welcome to Neo's Signal Quest! Help Neo, a rural student in South Africa, navigate through the 7 OSI layers to successfully connect to her online class.
                <br><br>
                Neo lives in a remote area with limited internet access. Today she has an important online class, but she needs your help to make the right networking decisions to establish a connection.
                <br><br>
                Click "Start Game" to begin Neo's journey!
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <div class="game-interface">
                <div class="choices" id="choices">
                    <button class="choice-btn pulse" id="start-btn">
                        <i class="bi bi-play-circle"></i> Start Game
                    </button>
                </div>
                
                <div class="game-controls">
                    <button id="restart-btn">
                        <i class="bi bi-arrow-counterclockwise"></i> Restart
                    </button>
                    <button id="next-btn">
                        <i class="bi bi-arrow-right-circle"></i> Continue
                    </button>
                    <button id="retry-btn">
                        <i class="bi bi-arrow-repeat"></i> Try Again
                    </button>
                </div>
            </div>
        </div>
        
        <div class="info-panel">
            <h3 id="current-layer-title"><i class="bi bi-info-circle"></i> The OSI Model</h3>
            <div class="layer-description" id="layer-description">
                The OSI (Open Systems Interconnection) model is a conceptual framework that standardizes the functions of a telecommunication or computing system into seven abstraction layers. Each layer serves a specific role in the network communication process.
            </div>
        </div>
    </div>

    <!-- Vendor JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/bootstrap-icons/bootstrap-icons.json"></script>
    
    <!-- Game Script -->
    <script>
        // Game state
        const gameState = {
            currentLayer: 7, // Starting from Application Layer (7) down to Physical Layer (1)
            completedLayers: [],
            currentScene: 'intro',
            progress: 0
        };
        
        // DOM Elements
        const narrativeEl = document.getElementById('narrative');
        const choicesEl = document.getElementById('choices');
        const feedbackEl = document.getElementById('feedback');
        const nextBtn = document.getElementById('next-btn');
        const retryBtn = document.getElementById('retry-btn');
        const restartBtn = document.getElementById('restart-btn');
        const startBtn = document.getElementById('start-btn');
        const layerIndicator = document.getElementById('layer-indicator');
        const layerDescription = document.getElementById('layer-description');
        const currentLayerTitle = document.getElementById('current-layer-title');
        const progressBar = document.getElementById('progress-bar');
        const sceneImage = document.getElementById('scene-image');
        
        // Layer information
        const layers = {
            7: {
                name: "Application Layer",
                description: "The Application Layer is the OSI layer closest to the end user. It provides network services directly to user applications. Examples include HTTP, FTP, SMTP, and application protocols like those used in video conferencing software.",
                challenge: "Neo needs to select the right application for her online class that will work well with limited internet connectivity."
            },
            6: {
                name: "Presentation Layer",
                description: "The Presentation Layer prepares data for the application layer. It's responsible for data translation, encryption, and compression. This layer ensures that data sent from one system can be read by the application layer of another.",
                challenge: "Neo's device needs to handle different file formats and compression to optimize for low bandwidth."
            },
            5: {
                name: "Session Layer",
                description: "The Session Layer establishes, manages, and terminates connections between applications. It handles session setup, coordination, and termination, as well as authentication and reconnection if the network fails.",
                challenge: "Neo needs to maintain her class session despite connectivity issues."
            },
            4: {
                name: "Transport Layer",
                description: "The Transport Layer provides reliable data transfer between end systems. It breaks data into segments, handles error control, flow control, and ensures complete data transfer. TCP and UDP are protocols at this layer.",
                challenge: "Neo's data needs to be properly segmented and delivered reliably to ensure she doesn't miss important parts of the lesson."
            },
            3: {
                name: "Network Layer",
                description: "The Network Layer handles packet forwarding and routing through intermediate routers. It finds the best physical path for data to travel across the network. IP addresses operate at this layer.",
                challenge: "Neo's data packets need to find the best path through the network to reach her online classroom servers."
            },
            2: {
                name: "Data Link Layer",
                description: "The Data Link Layer provides node-to-node data transfer between two directly connected nodes. It detects and possibly corrects errors from the Physical Layer. It includes MAC addressing and protocols like Ethernet.",
                challenge: "Neo's device needs to establish a reliable link to her local network equipment."
            },
            1: {
                name: "Physical Layer",
                description: "The Physical Layer consists of the physical and electrical specifications of the data connection. It transmits raw bit streams over a physical medium. This includes cables, wireless signals, network cards, and other hardware components.",
                challenge: "Neo needs to establish a stable physical connection with adequate signal strength."
            }
        };
        
        // Game scenarios for each layer
        const scenarios = {
            7: { // Application Layer
                narrative: "Neo is ready to join her online class but needs to choose which application to use. The internet connection in her village is limited and sometimes unstable.",
                choices: [
                    {
                        text: "<i class='bi bi-camera-video'></i> Use high-quality video conferencing app (Zoom with video enabled)",
                        result: "failure",
                        feedback: "The high bandwidth requirements of video conferencing quickly overwhelm Neo's limited connection. The call keeps freezing and eventually drops. The application layer couldn't handle the data efficiently for her network conditions."
                    },
                    {
                        text: "<i class='bi bi-mic'></i> Use audio-only mode in a conferencing app",
                        result: "success",
                        feedback: "Good choice! By using audio-only mode, Neo can still participate in her class while using much less bandwidth. The application layer efficiently serves her needs within the network constraints."
                    },
                    {
                        text: "<i class='bi bi-download'></i> Download class materials beforehand and participate via text chat",
                        result: "success",
                        feedback: "Excellent strategy! By downloading materials ahead of time and using text chat for communication, Neo minimizes real-time data needs. The application layer is handling the most appropriate protocols for her situation."
                    }
                ]
            },
            6: { // Presentation Layer
                narrative: "Neo's learning materials contain various types of content. Her device needs to handle these efficiently to save bandwidth and storage.",
                choices: [
                    {
                        text: "<i class='bi bi-file-earmark-image'></i> Download all materials in their original high-resolution formats",
                        result: "failure",
                        feedback: "The uncompressed files are too large for Neo's connection and device storage. The presentation layer failed to optimize the data formats for her constraints."
                    },
                    {
                        text: "<i class='bi bi-file-zip'></i> Request compressed versions of all files",
                        result: "success",
                        feedback: "Good choice! The presentation layer properly compresses the data, making it much faster to download while still maintaining usability."
                    },
                    {
                        text: "<i class='bi bi-file-earmark-text'></i> Convert video content to audio-only and images to lower resolution",
                        result: "success",
                        feedback: "Excellent! The presentation layer translates the content into more appropriate formats, significantly reducing data needs while preserving the essential information."
                    }
                ]
            },
            5: { // Session Layer
                narrative: "Neo's internet connection occasionally drops. How should her system handle the session with the learning platform?",
                choices: [
                    {
                        text: "<i class='bi bi-plug'></i> Set up automatic reconnection with session persistence",
                        result: "success",
                        feedback: "Perfect! The session layer maintains information about Neo's connection and can automatically resume where she left off when the connection returns."
                    },
                    {
                        text: "<i class='bi bi-power'></i> Manually reconnect and restart the session each time",
                        result: "failure",
                        feedback: "Neo gets frustrated as she has to log in repeatedly and loses her place in the lesson each time. The session layer isn't being used effectively to maintain continuity."
                    },
                    {
                        text: "<i class='bi bi-save'></i> Implement checkpoints to resume downloads",
                        result: "success",
                        feedback: "Good thinking! The session layer keeps track of what's been downloaded, allowing Neo to resume from where she left off rather than starting over each time the connection drops."
                    }
                ]
            },
            4: { // Transport Layer
                narrative: "Neo's learning platform needs to send various types of data. How should the transport layer handle this data?",
                choices: [
                    {
                        text: "<i class='bi bi-shield-check'></i> Use TCP for everything to ensure reliability",
                        result: "failure",
                        feedback: "While reliable, using TCP for everything creates unnecessary overhead for real-time components like video chat. Neo's connection struggles with the constant acknowledgments and retransmissions."
                    },
                    {
                        text: "<i class='bi bi-lightning'></i> Use UDP for everything to maximize speed",
                        result: "failure",
                        feedback: "Using UDP for everything means Neo frequently misses important parts of the lecture materials and assignments. Critical data needs reliability that UDP doesn't provide."
                    },
                    {
                        text: "<i class='bi bi-arrow-left-right'></i> Use TCP for course materials and UDP for real-time communication",
                        result: "success",
                        feedback: "Perfect balance! TCP ensures Neo gets complete course materials without corruption, while UDP allows for faster real-time communication even on her limited connection."
                    }
                ]
            },
            3: { // Network Layer
                narrative: "Neo's data needs to travel across multiple networks to reach her school's servers. How should routing be handled?",
                choices: [
                    {
                        text: "<i class='bi bi-signpost'></i> Use static routing to her school's server",
                        result: "failure",
                        feedback: "The static route becomes congested during peak hours, and Neo's data packets get delayed or lost. The network layer isn't adapting to changing network conditions."
                    },
                    {
                        text: "<i class='bi bi-signpost-split'></i> Implement dynamic routing to find the best path",
                        result: "success",
                        feedback: "Good choice! Dynamic routing allows the network layer to adapt to changing network conditions, finding the least congested path for Neo's data."
                    },
                    {
                        text: "<i class='bi bi-server'></i> Connect through a local CDN (Content Delivery Network) node",
                        result: "success",
                        feedback: "Excellent strategy! The network layer routes Neo's requests to a nearby CDN node, significantly reducing the distance data needs to travel and improving her connection quality."
                    }
                ]
            },
            2: { // Data Link Layer
                narrative: "Neo's device needs to communicate with her local network equipment. How should the data link layer be configured?",
                choices: [
                    {
                        text: "<i class='bi bi-speedometer2'></i> Configure for maximum throughput without error checking",
                        result: "failure",
                        feedback: "Without proper error detection, data becomes corrupted during transfer due to local interference. Neo receives garbled information and misses key concepts."
                    },
                    {
                        text: "<i class='bi bi-check-circle'></i> Use strong error detection and correction",
                        result: "success",
                        feedback: "Good choice! The data link layer catches and corrects errors caused by local interference, ensuring Neo receives accurate information even when conditions aren't ideal."
                    },
                    {
                        text: "<i class='bi bi-sliders'></i> Implement adaptive error correction based on signal quality",
                        result: "success",
                        feedback: "Excellent! The data link layer dynamically adjusts its error correction strength based on current conditions, optimizing both reliability and efficiency for Neo's connection."
                    }
                ]
            },
            1: { // Physical Layer
                narrative: "Neo needs a stable physical connection to access her online class. What should she do?",
                choices: [
                    {
                        text: "<i class='bi bi-phone'></i> Use her phone's cellular data indoors",
                        result: "failure",
                        feedback: "The cellular signal is too weak inside Neo's home, causing frequent disconnections. The physical layer can't maintain a stable bit transmission."
                    },
                    {
                        text: "<i class='bi bi-wifi'></i> Connect to the community Wi-Fi from inside her home",
                        result: "failure",
                        feedback: "The community Wi-Fi signal barely reaches Neo's home, resulting in a weak and unstable connection. The physical layer struggles with maintaining consistent signal strength."
                    },
                    {
                        text: "<i class='bi bi-geo-alt'></i> Walk to a nearby hill for better cellular reception",
                        result: "success",
                        feedback: "Good solution! By finding a location with stronger signal, Neo ensures the physical layer has adequate signal strength to maintain a stable connection throughout her class."
                    }
                ]
            },
            complete: {
                narrative: "Congratulations! Neo has successfully navigated all seven OSI layers and established a stable connection to her online class. Thanks to your help, she can now access her education reliably despite living in a remote area with limited connectivity.\n\nBy making smart choices at each layer of the networking stack, you've helped bridge the digital divide and ensured that Neo doesn't miss out on learning opportunities.",
                choices: []
            }
        };
        
        // Event Listeners
        startBtn.addEventListener('click', startGame);
        nextBtn.addEventListener('click', moveToNextLayer);
        retryBtn.addEventListener('click', retryCurrentLayer);
        restartBtn.addEventListener('click', restartGame);
        
        // Initialize the game
        function startGame() {
            // Animate the start button
            startBtn.classList.remove('pulse');
            startBtn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                startBtn.style.transform = 'scale(1)';
            }, 200);
            
            gameState.currentScene = gameState.currentLayer;
            updateLayerIndicator();
            loadScene(gameState.currentLayer);
            updateProgress();
        }
        
        // Load a specific scene/layer
        function loadScene(sceneId) {
            // Hide buttons that might be visible
            nextBtn.style.display = 'none';
            retryBtn.style.display = 'none';
            feedbackEl.style.display = 'none';
            
            const scene = scenarios[sceneId];
            if (!scene) return;
            
            // Update narrative
            narrativeEl.innerHTML = scene.narrative;
            
            // Update layer information
            if (layers[sceneId]) {
                currentLayerTitle.innerHTML = `<i class="bi bi-${getLayerIcon(sceneId)}"></i> ${layers[sceneId].name}`;
                layerDescription.textContent = layers[sceneId].description + " " + layers[sceneId].challenge;
            } else {
                currentLayerTitle.innerHTML = '<i class="bi bi-trophy"></i> Quest Complete!';
                layerDescription.textContent = "You've helped Neo navigate through all seven layers of the OSI model and successfully connect to her online class!";
            }
            
            // Update scene image
            if (sceneId === 'complete') {
                sceneImage.innerHTML = `
                    <div>
                        <i class="bi bi-trophy-fill" style="font-size: 3rem; color: gold; margin-bottom: 1rem;"></i>
                        <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;">Mission Accomplished!</h4>
                        <p>Neo successfully connected to her class!</p>
                    </div>
                `;
            } else if (layers[sceneId]) {
                sceneImage.innerHTML = `
                    <div>
                        <i class="bi bi-${getLayerIcon(sceneId)}" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                        <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;">Layer ${sceneId}: ${layers[sceneId].name}</h4>
                        <p>${layers[sceneId].challenge}</p>
                    </div>
                `;
            }
            
            // Populate choices
            populateChoices(scene);
        }
        
        // Get appropriate icon for each layer
        function getLayerIcon(layerId) {
            const icons = {
                7: 'app-indicator',
                6: 'file-earmark-binary',
                5: 'people',
                4: 'truck',
                3: 'diagram-3',
                2: 'hdd-network',
                1: 'wifi'
            };
            return icons[layerId] || 'question-circle';
        }
        
        // Populate choices
        function populateChoices(scene) {
            choicesEl.innerHTML = '';
            
            scene.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.classList.add('choice-btn');
                button.innerHTML = choice.text;
                
                button.addEventListener('click', () => {
                    // Animate button click
                    button.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        button.style.transform = 'scale(1)';
                        makeChoice(index);
                    }, 200);
                });
                
                choicesEl.appendChild(button);
            });
            
            // For the completion scene
            if (gameState.currentScene === 'complete') {
                const button = document.createElement('button');
                button.classList.add('choice-btn', 'pulse');
                button.innerHTML = '<i class="bi bi-arrow-repeat"></i> Play Again';
                button.addEventListener('click', restartGame);
                choicesEl.appendChild(button);
            }
        }
        
        // Process player choice
        function makeChoice(choiceIndex) {
            const scene = scenarios[gameState.currentScene];
            const choice = scene.choices[choiceIndex];
            
            // Display feedback
            feedbackEl.innerHTML = choice.feedback;
            feedbackEl.className = 'feedback ' + choice.result;
            feedbackEl.style.display = 'block';
            
            // Hide choices
            choicesEl.innerHTML = '';
            
            if (choice.result === 'success') {
                // Show next button for success
                nextBtn.style.display = 'block';
                gameState.completedLayers.push(gameState.currentLayer);
            } else {
                // Show retry button for failure
                retryBtn.style.display = 'block';
            }
            
            updateProgress();
        }
        
        // Move to next layer
        function moveToNextLayer() {
            // Animate the next button
            nextBtn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                nextBtn.style.transform = 'scale(1)';
            }, 200);
            
            gameState.currentLayer -= 1; // Move down the OSI stack
            
            if (gameState.currentLayer < 1) {
                // Game complete
                gameState.currentScene = 'complete';
            } else {
                gameState.currentScene = gameState.currentLayer;
            }
            
            updateLayerIndicator();
            loadScene(gameState.currentScene);
            updateProgress();
        }
        
        // Retry current layer
        function retryCurrentLayer() {
            // Animate the retry button
            retryBtn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                retryBtn.style.transform = 'scale(1)';
            }, 200);
            
            loadScene(gameState.currentLayer);
        }
        
        // Restart the game
        function restartGame() {
            // Animate the restart button
            restartBtn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                restartBtn.style.transform = 'scale(1)';
            }, 200);
            
            gameState.currentLayer = 7;
            gameState.completedLayers = [];
            gameState.currentScene = gameState.currentLayer;
            updateLayerIndicator();
            loadScene(gameState.currentLayer);
            updateProgress();
        }
        
        // Update layer indicator
        function updateLayerIndicator() {
            const layerElements = layerIndicator.querySelectorAll('.layer');
            
            layerElements.forEach(layerEl => {
                const layerNum = parseInt(layerEl.dataset.layer);
                layerEl.classList.remove('active', 'completed');
                
                if (layerNum === gameState.currentLayer) {
                    layerEl.classList.add('active');
                } else if (gameState.completedLayers.includes(layerNum)) {
                    layerEl.classList.add('completed');
                }
            });
        }
        
        // Update progress bar
        function updateProgress() {
            const totalLayers = 7;
            const completedCount = gameState.completedLayers.length;
            const progressPercentage = (completedCount / totalLayers) * 100;
            
            progressBar.style.width = progressPercentage + '%';
            
            // Add celebration when completing all layers
            if (completedCount === totalLayers) {
                progressBar.style.background = 'linear-gradient(90deg, var(--primary-color), gold)';
            } else {
                progressBar.style.background = 'linear-gradient(90deg, var(--primary-color), var(--primary-dark))';
            }
        }
    </script>
</body>
</html>
</html>